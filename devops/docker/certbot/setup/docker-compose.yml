version: '2'
services:
  web-certbot-setup:
    labels:
      io.rancher.container.start_once: true
    image: certbot/certbot
    cap_drop:
      - ALL
    volumes:
      - web-certs.ssl-testing:/etc/letsencrypt
      - web-certbot-webroot.ssl-testing:/data/letsencrypt
    command:
      - certonly
      - "--webroot" 
      - "-m chris.harris@kitware.com"
      - "--agree-tos"
      - "--no-eff-email" 
      - "--webroot-path=/data/letsencrypt"
      - "-d materialsdatabank.org"
      - "-d www.materialsdatabank.org
    
volumes:
  web-certs.mdb:
    external: true
    driver: rancher-nfs
  web-certbot-webroot.mdb:
    external: true
    driver: rancher-nfs
